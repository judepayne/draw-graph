shadow$provide.module$node_modules$svg_pan_zoom$src$svg_pan_zoom=function(global,require,module,exports){var Wheel=require("module$node_modules$svg_pan_zoom$src$uniwheel"),ControlIcons=require("module$node_modules$svg_pan_zoom$src$control_icons"),Utils=require("module$node_modules$svg_pan_zoom$src$utilities"),SvgUtils=require("module$node_modules$svg_pan_zoom$src$svg_utilities"),ShadowViewport=require("module$node_modules$svg_pan_zoom$src$shadow_viewport"),SvgPanZoom=function(svg,options){this.init(svg,
options)},optionsDefaults={viewportSelector:".svg-pan-zoom_viewport",panEnabled:!0,controlIconsEnabled:!1,zoomEnabled:!0,dblClickZoomEnabled:!0,mouseWheelZoomEnabled:!0,preventMouseEventsDefault:!0,zoomScaleSensitivity:.1,minZoom:.5,maxZoom:10,fit:!0,contain:!1,center:!0,refreshRate:"auto",beforeZoom:null,onZoom:null,beforePan:null,onPan:null,customEventsHandler:null,eventsListenerElement:null,onUpdatedCTM:null},passiveListenerOption={passive:!0};SvgPanZoom.prototype.init=function(svg,options){var that=
this;this.svg=svg;this.defs=svg.querySelector("defs");SvgUtils.setupSvgAttributes(this.svg);this.options=Utils.extend(Utils.extend({},optionsDefaults),options);this.state="none";svg=SvgUtils.getBoundingClientRectNormalized(svg);this.width=svg.width;this.height=svg.height;this.viewport=ShadowViewport(SvgUtils.getOrCreateViewport(this.svg,this.options.viewportSelector),{svg:this.svg,width:this.width,height:this.height,fit:this.options.fit,contain:this.options.contain,center:this.options.center,refreshRate:this.options.refreshRate,
beforeZoom:function(oldScale,newScale){if(that.viewport&&that.options.beforeZoom)return that.options.beforeZoom(oldScale,newScale)},onZoom:function(scale){if(that.viewport&&that.options.onZoom)return that.options.onZoom(scale)},beforePan:function(oldPoint,newPoint){if(that.viewport&&that.options.beforePan)return that.options.beforePan(oldPoint,newPoint)},onPan:function(point){if(that.viewport&&that.options.onPan)return that.options.onPan(point)},onUpdatedCTM:function(ctm){if(that.viewport&&that.options.onUpdatedCTM)return that.options.onUpdatedCTM(ctm)}});
svg=this.getPublicInstance();svg.setBeforeZoom(this.options.beforeZoom);svg.setOnZoom(this.options.onZoom);svg.setBeforePan(this.options.beforePan);svg.setOnPan(this.options.onPan);svg.setOnUpdatedCTM(this.options.onUpdatedCTM);this.options.controlIconsEnabled&&ControlIcons.enable(this);this.lastMouseWheelEventTime=Date.now();this.setupHandlers()};SvgPanZoom.prototype.setupHandlers=function(){var that=this,prevEvt=null;this.eventListeners={mousedown:function(evt){var result=that.handleMouseDown(evt,
prevEvt);prevEvt=evt;return result},touchstart:function(evt){var result=that.handleMouseDown(evt,prevEvt);prevEvt=evt;return result},mouseup:function(evt){return that.handleMouseUp(evt)},touchend:function(evt){return that.handleMouseUp(evt)},mousemove:function(evt){return that.handleMouseMove(evt)},touchmove:function(evt){return that.handleMouseMove(evt)},mouseleave:function(evt){return that.handleMouseUp(evt)},touchleave:function(evt){return that.handleMouseUp(evt)},touchcancel:function(evt){return that.handleMouseUp(evt)}};
if(null!=this.options.customEventsHandler){this.options.customEventsHandler.init({svgElement:this.svg,eventsListenerElement:this.options.eventsListenerElement,instance:this.getPublicInstance()});var haltEventListeners=this.options.customEventsHandler.haltEventListeners;if(haltEventListeners&&haltEventListeners.length)for(var i=haltEventListeners.length-1;0<=i;i--)this.eventListeners.hasOwnProperty(haltEventListeners[i])&&delete this.eventListeners[haltEventListeners[i]]}for(var event in this.eventListeners)(this.options.eventsListenerElement||
this.svg).addEventListener(event,this.eventListeners[event],this.options.preventMouseEventsDefault?!1:passiveListenerOption);this.options.mouseWheelZoomEnabled&&(this.options.mouseWheelZoomEnabled=!1,this.enableMouseWheelZoom())};SvgPanZoom.prototype.enableMouseWheelZoom=function(){if(!this.options.mouseWheelZoomEnabled){var that=this;this.wheelListener=function(evt){return that.handleMouseWheel(evt)};Wheel.on(this.options.eventsListenerElement||this.svg,this.wheelListener,!this.options.preventMouseEventsDefault);
this.options.mouseWheelZoomEnabled=!0}};SvgPanZoom.prototype.disableMouseWheelZoom=function(){this.options.mouseWheelZoomEnabled&&(Wheel.off(this.options.eventsListenerElement||this.svg,this.wheelListener,!this.options.preventMouseEventsDefault),this.options.mouseWheelZoomEnabled=!1)};SvgPanZoom.prototype.handleMouseWheel=function(evt){if(this.options.zoomEnabled&&"none"===this.state){this.options.preventMouseEventsDefault&&(evt.preventDefault?evt.preventDefault():evt.returnValue=!1);var delta=evt.deltaY||
1,timeDelta=Date.now()-this.lastMouseWheelEventTime;timeDelta=3+Math.max(0,30-timeDelta);this.lastMouseWheelEventTime=Date.now();"deltaMode"in evt&&0===evt.deltaMode&&evt.wheelDelta&&(delta=0===evt.deltaY?0:Math.abs(evt.wheelDelta)/evt.deltaY);delta=-.3<delta&&.3>delta?delta:(0<delta?1:-1)*Math.log(Math.abs(delta)+10)/timeDelta;timeDelta=this.svg.getScreenCTM().inverse();evt=SvgUtils.getEventPoint(evt,this.svg).matrixTransform(timeDelta);this.zoomAtPoint(Math.pow(1+this.options.zoomScaleSensitivity,
-1*delta),evt)}};SvgPanZoom.prototype.zoomAtPoint=function(zoomScale,point,zoomAbsolute){var originalState=this.viewport.getOriginalState();zoomAbsolute?(zoomScale=Math.max(this.options.minZoom*originalState.zoom,Math.min(this.options.maxZoom*originalState.zoom,zoomScale)),zoomScale/=this.getZoom()):this.getZoom()*zoomScale<this.options.minZoom*originalState.zoom?zoomScale=this.options.minZoom*originalState.zoom/this.getZoom():this.getZoom()*zoomScale>this.options.maxZoom*originalState.zoom&&(zoomScale=
this.options.maxZoom*originalState.zoom/this.getZoom());zoomAbsolute=this.viewport.getCTM();point=point.matrixTransform(zoomAbsolute.inverse());zoomScale=this.svg.createSVGMatrix().translate(point.x,point.y).scale(zoomScale).translate(-point.x,-point.y);zoomScale=zoomAbsolute.multiply(zoomScale);zoomScale.a!==zoomAbsolute.a&&this.viewport.setCTM(zoomScale)};SvgPanZoom.prototype.zoom=function(scale,absolute){this.zoomAtPoint(scale,SvgUtils.getSvgCenterPoint(this.svg,this.width,this.height),absolute)};
SvgPanZoom.prototype.publicZoom=function(scale,absolute){absolute&&(scale=this.computeFromRelativeZoom(scale));this.zoom(scale,absolute)};SvgPanZoom.prototype.publicZoomAtPoint=function(scale,point,absolute){absolute&&(scale=this.computeFromRelativeZoom(scale));if("SVGPoint"!==Utils.getType(point))if("x"in point&&"y"in point)point=SvgUtils.createSVGPoint(this.svg,point.x,point.y);else throw Error("Given point is invalid");this.zoomAtPoint(scale,point,absolute)};SvgPanZoom.prototype.getZoom=function(){return this.viewport.getZoom()};
SvgPanZoom.prototype.getRelativeZoom=function(){return this.viewport.getRelativeZoom()};SvgPanZoom.prototype.computeFromRelativeZoom=function(zoom){return zoom*this.viewport.getOriginalState().zoom};SvgPanZoom.prototype.resetZoom=function(){var originalState=this.viewport.getOriginalState();this.zoom(originalState.zoom,!0)};SvgPanZoom.prototype.resetPan=function(){this.pan(this.viewport.getOriginalState())};SvgPanZoom.prototype.reset=function(){this.resetZoom();this.resetPan()};SvgPanZoom.prototype.handleDblClick=
function(evt){this.options.preventMouseEventsDefault&&(evt.preventDefault?evt.preventDefault():evt.returnValue=!1);if(this.options.controlIconsEnabled&&-1<(evt.target.getAttribute("class")||"").indexOf("svg-pan-zoom-control"))return!1;var zoomFactor=evt.shiftKey?1/(2*(1+this.options.zoomScaleSensitivity)):2*(1+this.options.zoomScaleSensitivity);evt=SvgUtils.getEventPoint(evt,this.svg).matrixTransform(this.svg.getScreenCTM().inverse());this.zoomAtPoint(zoomFactor,evt)};SvgPanZoom.prototype.handleMouseDown=
function(evt,prevEvt){this.options.preventMouseEventsDefault&&(evt.preventDefault?evt.preventDefault():evt.returnValue=!1);Utils.mouseAndTouchNormalize(evt,this.svg);this.options.dblClickZoomEnabled&&Utils.isDblClick(evt,prevEvt)?this.handleDblClick(evt):(this.state="pan",this.firstEventCTM=this.viewport.getCTM(),this.stateOrigin=SvgUtils.getEventPoint(evt,this.svg).matrixTransform(this.firstEventCTM.inverse()))};SvgPanZoom.prototype.handleMouseMove=function(evt){this.options.preventMouseEventsDefault&&
(evt.preventDefault?evt.preventDefault():evt.returnValue=!1);"pan"===this.state&&this.options.panEnabled&&(evt=SvgUtils.getEventPoint(evt,this.svg).matrixTransform(this.firstEventCTM.inverse()),evt=this.firstEventCTM.translate(evt.x-this.stateOrigin.x,evt.y-this.stateOrigin.y),this.viewport.setCTM(evt))};SvgPanZoom.prototype.handleMouseUp=function(evt){this.options.preventMouseEventsDefault&&(evt.preventDefault?evt.preventDefault():evt.returnValue=!1);"pan"===this.state&&(this.state="none")};SvgPanZoom.prototype.fit=
function(){var viewBox=this.viewport.getViewBox();this.zoom(Math.min(this.width/viewBox.width,this.height/viewBox.height),!0)};SvgPanZoom.prototype.contain=function(){var viewBox=this.viewport.getViewBox();this.zoom(Math.max(this.width/viewBox.width,this.height/viewBox.height),!0)};SvgPanZoom.prototype.center=function(){var viewBox=this.viewport.getViewBox(),offsetX=.5*(this.width-(viewBox.width+2*viewBox.x)*this.getZoom());viewBox=.5*(this.height-(viewBox.height+2*viewBox.y)*this.getZoom());this.getPublicInstance().pan({x:offsetX,
y:viewBox})};SvgPanZoom.prototype.updateBBox=function(){this.viewport.simpleViewBoxCache()};SvgPanZoom.prototype.pan=function(point){var viewportCTM=this.viewport.getCTM();viewportCTM.e=point.x;viewportCTM.f=point.y;this.viewport.setCTM(viewportCTM)};SvgPanZoom.prototype.panBy=function(point){var viewportCTM=this.viewport.getCTM();viewportCTM.e+=point.x;viewportCTM.f+=point.y;this.viewport.setCTM(viewportCTM)};SvgPanZoom.prototype.getPan=function(){var state=this.viewport.getState();return{x:state.x,
y:state.y}};SvgPanZoom.prototype.resize=function(){var boundingClientRectNormalized=SvgUtils.getBoundingClientRectNormalized(this.svg);this.width=boundingClientRectNormalized.width;this.height=boundingClientRectNormalized.height;boundingClientRectNormalized=this.viewport;boundingClientRectNormalized.options.width=this.width;boundingClientRectNormalized.options.height=this.height;boundingClientRectNormalized.processCTM();this.options.controlIconsEnabled&&(this.getPublicInstance().disableControlIcons(),
this.getPublicInstance().enableControlIcons())};SvgPanZoom.prototype.destroy=function(){var that=this;this.onUpdatedCTM=this.onPan=this.beforePan=this.onZoom=this.beforeZoom=null;null!=this.options.customEventsHandler&&this.options.customEventsHandler.destroy({svgElement:this.svg,eventsListenerElement:this.options.eventsListenerElement,instance:this.getPublicInstance()});for(var event in this.eventListeners)(this.options.eventsListenerElement||this.svg).removeEventListener(event,this.eventListeners[event],
this.options.preventMouseEventsDefault?!1:passiveListenerOption);this.disableMouseWheelZoom();this.getPublicInstance().disableControlIcons();this.reset();instancesStore=instancesStore.filter(function(instance){return instance.svg!==that.svg});delete this.options;delete this.viewport;delete this.publicInstance;delete this.pi;this.getPublicInstance=function(){return null}};SvgPanZoom.prototype.getPublicInstance=function(){var that=this;this.publicInstance||(this.publicInstance=this.pi={enablePan:function(){that.options.panEnabled=
!0;return that.pi},disablePan:function(){that.options.panEnabled=!1;return that.pi},isPanEnabled:function(){return!!that.options.panEnabled},pan:function(point){that.pan(point);return that.pi},panBy:function(point){that.panBy(point);return that.pi},getPan:function(){return that.getPan()},setBeforePan:function(fn){that.options.beforePan=null===fn?null:Utils.proxy(fn,that.publicInstance);return that.pi},setOnPan:function(fn){that.options.onPan=null===fn?null:Utils.proxy(fn,that.publicInstance);return that.pi},
enableZoom:function(){that.options.zoomEnabled=!0;return that.pi},disableZoom:function(){that.options.zoomEnabled=!1;return that.pi},isZoomEnabled:function(){return!!that.options.zoomEnabled},enableControlIcons:function(){that.options.controlIconsEnabled||(that.options.controlIconsEnabled=!0,ControlIcons.enable(that));return that.pi},disableControlIcons:function(){that.options.controlIconsEnabled&&(that.options.controlIconsEnabled=!1,ControlIcons.disable(that));return that.pi},isControlIconsEnabled:function(){return!!that.options.controlIconsEnabled},
enableDblClickZoom:function(){that.options.dblClickZoomEnabled=!0;return that.pi},disableDblClickZoom:function(){that.options.dblClickZoomEnabled=!1;return that.pi},isDblClickZoomEnabled:function(){return!!that.options.dblClickZoomEnabled},enableMouseWheelZoom:function(){that.enableMouseWheelZoom();return that.pi},disableMouseWheelZoom:function(){that.disableMouseWheelZoom();return that.pi},isMouseWheelZoomEnabled:function(){return!!that.options.mouseWheelZoomEnabled},setZoomScaleSensitivity:function(scale){that.options.zoomScaleSensitivity=
scale;return that.pi},setMinZoom:function(zoom){that.options.minZoom=zoom;return that.pi},setMaxZoom:function(zoom){that.options.maxZoom=zoom;return that.pi},setBeforeZoom:function(fn){that.options.beforeZoom=null===fn?null:Utils.proxy(fn,that.publicInstance);return that.pi},setOnZoom:function(fn){that.options.onZoom=null===fn?null:Utils.proxy(fn,that.publicInstance);return that.pi},zoom:function(scale){that.publicZoom(scale,!0);return that.pi},zoomBy:function(scale){that.publicZoom(scale,!1);return that.pi},
zoomAtPoint:function(scale,point){that.publicZoomAtPoint(scale,point,!0);return that.pi},zoomAtPointBy:function(scale,point){that.publicZoomAtPoint(scale,point,!1);return that.pi},zoomIn:function(){this.zoomBy(1+that.options.zoomScaleSensitivity);return that.pi},zoomOut:function(){this.zoomBy(1/(1+that.options.zoomScaleSensitivity));return that.pi},getZoom:function(){return that.getRelativeZoom()},setOnUpdatedCTM:function(fn){that.options.onUpdatedCTM=null===fn?null:Utils.proxy(fn,that.publicInstance);
return that.pi},resetZoom:function(){that.resetZoom();return that.pi},resetPan:function(){that.resetPan();return that.pi},reset:function(){that.reset();return that.pi},fit:function(){that.fit();return that.pi},contain:function(){that.contain();return that.pi},center:function(){that.center();return that.pi},updateBBox:function(){that.updateBBox();return that.pi},resize:function(){that.resize();return that.pi},getSizes:function(){return{width:that.width,height:that.height,realZoom:that.getZoom(),viewBox:that.viewport.getViewBox()}},
destroy:function(){that.destroy();return that.pi}});return this.publicInstance};var instancesStore=[];module.exports=function(elementOrSelector,options){elementOrSelector=Utils.getSvg(elementOrSelector);if(null===elementOrSelector)return null;for(var i=instancesStore.length-1;0<=i;i--)if(instancesStore[i].svg===elementOrSelector)return instancesStore[i].instance.getPublicInstance();instancesStore.push({svg:elementOrSelector,instance:new SvgPanZoom(elementOrSelector,options)});return instancesStore[instancesStore.length-
1].instance.getPublicInstance()}}
//# sourceMappingURL=module$node_modules$svg_pan_zoom$src$svg_pan_zoom.js.map
