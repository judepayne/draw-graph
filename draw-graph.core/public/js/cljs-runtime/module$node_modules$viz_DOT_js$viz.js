shadow$provide.module$node_modules$viz_DOT_js$viz=function(global$jscomp$0,require,module$jscomp$0,exports){(function(global,factory){"object"===typeof exports&&"undefined"!==typeof module$jscomp$0?module$jscomp$0.exports=factory():"function"===typeof define&&define.amd?define(factory):global.Viz=factory()})(this,function(){function b64EncodeUnicode(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}))}function defaultScale(){return"devicePixelRatio"in
window&&1<window.devicePixelRatio?window.devicePixelRatio:1}function svgXmlToImageElement(svgXml){var _ref=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},_ref$scale=_ref.scale,scale=void 0===_ref$scale?defaultScale():_ref$scale;_ref$scale=_ref.mimeType;var mimeType=void 0===_ref$scale?"image/png":_ref$scale;_ref=_ref.quality;var quality=void 0===_ref?1:_ref;return new Promise(function(resolve,reject){var svgImage=new Image;svgImage.onload=function(){var canvas=document.createElement("canvas");
canvas.width=svgImage.width*scale;canvas.height=svgImage.height*scale;canvas.getContext("2d").drawImage(svgImage,0,0,canvas.width,canvas.height);canvas.toBlob(function(blob){var image=new Image;image.src=URL.createObjectURL(blob);image.width=svgImage.width;image.height=svgImage.height;resolve(image)},mimeType,quality)};svgImage.onerror=function(e){reject("error"in e?e.error:Error("Error loading SVG"))};svgImage.src="data:image/svg+xml;base64,"+b64EncodeUnicode(svgXml)})}function svgXmlToImageElementFabric(svgXml){var _ref2=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},_ref2$scale=_ref2.scale,scale=void 0===_ref2$scale?defaultScale():_ref2$scale;_ref2$scale=_ref2.mimeType;_ref2$scale=void 0===_ref2$scale?"image/png":_ref2$scale;_ref2=_ref2.quality;var quality=void 0===_ref2?1:_ref2,format=void 0;"image/jpeg"==_ref2$scale?format="jpeg":"image/png"==_ref2$scale&&(format="png");return new Promise(function(resolve,reject){fabric.loadSVGFromString(svgXml,function(objects,options){0==objects.length&&reject(Error("Error loading SVG with Fabric"));
var element=document.createElement("canvas");element.width=options.width;element.height=options.height;element=new fabric.Canvas(element,{enableRetinaScaling:!1});objects=fabric.util.groupSVGElements(objects,options);element.add(objects).renderAll();objects=new Image;objects.src=element.toDataURL({format:format,multiplier:scale,quality:quality});objects.width=options.width;objects.height=options.height;resolve(objects)})})}var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?
function(obj){return typeof obj}:function(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function");},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in
descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){protoProps&&defineProperties(Constructor.prototype,protoProps);staticProps&&defineProperties(Constructor,staticProps);return Constructor}}(),_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i],key;for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},
WorkerWrapper=function(){function WorkerWrapper(worker){var _this=this;classCallCheck(this,WorkerWrapper);this.worker=worker;this.listeners=[];this.nextId=0;this.worker.addEventListener("message",function(event){var id=event.data.id;_this.listeners[id](event.data.error,event.data.result);delete _this.listeners[id]})}createClass(WorkerWrapper,[{key:"render",value:function(src,options){var _this2=this;return new Promise(function(resolve,reject){var id=_this2.nextId++;_this2.listeners[id]=function(error,
result){error?reject(Error(error.message,error.fileName,error.lineNumber)):resolve(result)};_this2.worker.postMessage({id:id,src:src,options:options})})}}]);return WorkerWrapper}(),ModuleWrapper=function ModuleWrapper(module,render){classCallCheck(this,ModuleWrapper);var instance=module();this.render=function(src,options){return new Promise(function(resolve,reject){try{resolve(render(instance,src,options))}catch(error){reject(error)}})}};return function(){function Viz(){var _ref3=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:{},workerURL=_ref3.workerURL,worker=_ref3.worker,Module=_ref3.Module;_ref3=_ref3.render;classCallCheck(this,Viz);if("undefined"!==typeof workerURL)this.wrapper=new WorkerWrapper(new Worker(workerURL));else if("undefined"!==typeof worker)this.wrapper=new WorkerWrapper(worker);else if("undefined"!==typeof Module&&"undefined"!==typeof _ref3)this.wrapper=new ModuleWrapper(Module,_ref3);else if("undefined"!==typeof Viz.Module&&"undefined"!==typeof Viz.render)this.wrapper=
new ModuleWrapper(Viz.Module,Viz.render);else throw Error("Must specify workerURL or worker option, Module and render options, or include one of full.render.js or lite.render.js after viz.js.");}createClass(Viz,[{key:"renderString",value:function(src){var _ref4=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},_ref4$format=_ref4.format;_ref4$format=void 0===_ref4$format?"svg":_ref4$format;var _ref4$engine=_ref4.engine;_ref4$engine=void 0===_ref4$engine?"dot":_ref4$engine;var _ref4$files=_ref4.files;
_ref4$files=void 0===_ref4$files?[]:_ref4$files;var _ref4$images=_ref4.images;_ref4$images=void 0===_ref4$images?[]:_ref4$images;var _ref4$yInvert=_ref4.yInvert;_ref4$yInvert=void 0===_ref4$yInvert?!1:_ref4$yInvert;_ref4=_ref4.nop;_ref4=void 0===_ref4?0:_ref4;for(var i=0;i<_ref4$images.length;i++)_ref4$files.push({path:_ref4$images[i].path,data:'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8" standalone\x3d"no"?\x3e\n\x3c!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"\x3e\n\x3csvg width\x3d"'+
_ref4$images[i].width+'" height\x3d"'+_ref4$images[i].height+'"\x3e\x3c/svg\x3e'});return this.wrapper.render(src,{format:_ref4$format,engine:_ref4$engine,files:_ref4$files,images:_ref4$images,yInvert:_ref4$yInvert,nop:_ref4})}},{key:"renderSVGElement",value:function(src){return this.renderString(src,_extends({},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},{format:"svg"})).then(function(str){return(new DOMParser).parseFromString(str,"image/svg+xml").documentElement})}},{key:"renderImageElement",
value:function(src){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},scale=options.scale,mimeType=options.mimeType,quality=options.quality;return this.renderString(src,_extends({},options,{format:"svg"})).then(function(str){return"object"===("undefined"===typeof fabric?"undefined":_typeof(fabric))&&fabric.loadSVGFromString?svgXmlToImageElementFabric(str,{scale:scale,mimeType:mimeType,quality:quality}):svgXmlToImageElement(str,{scale:scale,mimeType:mimeType,quality:quality})})}},
{key:"renderJSONObject",value:function(src){var options=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},format=options.format;if("json"!==format||"json0"!==format)format="json";return this.renderString(src,_extends({},options,{format:format})).then(function(str){return JSON.parse(str)})}}]);return Viz}()})}
//# sourceMappingURL=module$node_modules$viz_DOT_js$viz.js.map
